<!doctype html>
<html lang="en">
	<head>
		<title>pyitunesweb | github.com/tommed/pyitunesweb</title>
		<link rel="stylesheet" href="css/default.css"></link>
		<script>
			icon = 'images/track.png'
			function $(elem) { return document.getElementById(elem); }
			function play(src, artist, track) { 
				$('player').src = "#{pitpath}iTunes Music/"+src
				$('player').load()
				$('player').play() 
				show_notification(artist, track)
			}
			function show_notification(artist, track) {
				if (window.webkitNotifications.checkPermission() == 0) {
					window.webkitNotifications.createNotification(icon, artist, track).show()
				} else {
					window.webkitNotifications.requestPermission();
				}
			}
		</script>
	</head>
	<body>

		<div class="player">
			<audio id="player" controls autobuffer autoplay></audio>
			<form method="get" action="index.cgi">
				<input type="search" name="search" value="#{search_default}" results="5" id="search"/>
			</form>
			<p>#{track_count} tracks | <a href="install/scan.cgi">Scan</a> | <a href="install/">Reset</a></p>
		</div>

		<!-- Tracks -->
		<ul class="songlist">
	<?py lastalbum = "_"
for song in songs: 
	artwork_html = get_album_artwork(song, lastalbum)
	lastalbum = song[4] ?>
		<li>
			#{artwork_html}
			<a href="javascript:play('${song[3].replace("'","\\'")}','${song[1].replace("'","\\'")}','${song[2].replace("'","\\'")}');">
				${song[2]}
			</a>
		</li>
<?py #end ?>
		</ul>

		<div class="pager">
<?py if page_number > 1: ?>
		<a href="index.cgi?page=${page_number-1}&search=${search_default}">&lt; Previous</a>
<?py #end ?>
	Page #{page_number} of #{page_count}
<?py if page_number != page_count: ?>
		<a href="index.cgi?page=${page_number+1}&search=${search_default}">Next &gt;</a>
<?py #end ?>
	</div>

	</body>
</html>
<!--
# vim: sw=2 ts=2 ai cin
-->
